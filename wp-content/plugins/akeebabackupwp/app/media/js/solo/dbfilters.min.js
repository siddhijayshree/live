/*
   2014-2017 Nicholas K. Dionysopoulos / Akeeba Ltd
 @license     GNU GPL version 3 or later
*/
if("undefined"==typeof Solo)var Solo={};"undefined"==typeof Solo.Dbfilters&&(Solo.Dbfilters={translations:{},currentRoot:null,loadingGif:""});Solo.Dbfilters.activeRootChanged=function(){var a=document.getElementById("active_root");Solo.Dbfilters.load({root:a.options[a.selectedIndex].value})};Solo.Dbfilters.load=function(a){a.verb="list";a={action:JSON.stringify(a)};Solo.System.doAjax(a,function(a){Solo.Dbfilters.render(a)},null,!1,15E3)};
Solo.Dbfilters.toggle=function(a,d,c){Solo.Fsfilters.toggle(a,d,c)};
Solo.Dbfilters.render=function(a){Solo.Dbfilters.currentRoot=a.root;var d=document.getElementById("tables");d.innerHTML="";for(var c in a.tables)if(a.tables.hasOwnProperty(c)){dbef=a.tables[c];var h=document.createElement("div");h.className="table-container";for(var k=["tables","tabledata"],e=0;e<k.length;e++){var g=k[e],b=document.createElement("span");b.className="table-icon-container btn btn-xs btn-default";b.setAttribute("title",Solo.Dbfilters.translations["COM_AKEEBA_DBFILTER_TYPE_"+g.toUpperCase()]);
switch(g){case "tables":b.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-ban"></span>');break;case "tabledata":b.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button fa fa-bars"></span>')}Solo.Tooltip.simpleTooltip(b);switch(dbef[g]){case 2:Solo.System.removeClass(b,"btn-default");Solo.System.addClass(b,"btn-danger");break;case 1:Solo.System.removeClass(b,"btn-default"),Solo.System.addClass(b,"btn-warning");case 0:Solo.System.addEventListener(b,"click",function(b,c,d){return function(){Solo.Dbfilters.toggle({root:a.root,
node:c,filter:d,verb:"toggle"},b)}}(b,c,g))}h.appendChild(b)}var b="fa-square-o",f="COM_AKEEBA_DBFILTER_TABLE_MISC";switch(dbef.type){case "table":b="fa-table";f="COM_AKEEBA_DBFILTER_TABLE_TABLE";break;case "view":b="fa-list-alt";f="COM_AKEEBA_DBFILTER_TABLE_VIEW";break;case "procedure":b="fa-terminal";f="COM_AKEEBA_DBFILTER_TABLE_PROCEDURE";break;case "function":b="fa-bolt";f="COM_AKEEBA_DBFILTER_TABLE_FUNCTION";break;case "trigger":b="fa-code-fork",f="COM_AKEEBA_DBFILTER_TABLE_TRIGGER"}k=document.createElement("span");
e=document.createElement("span");g=document.createElement("span");k.className="table-name";k.textContent=c;e.className="table-icon-container table-icon-noclick table-icon-small";e.setAttribute("title",Solo.Dbfilters.translations[f]);e.setAttribute("data-akeeba-tooltip-position","right");Solo.Tooltip.simpleTooltip(e);f=document.createElement("span");f.className="fa "+b;e.appendChild(f);g.className="table-icon-container table-icon-noclick table-icon-small";b=document.createElement("span");b.className=
"fa fa-ellipsis-v";b.style.color="#cccccc";g.appendChild(b);h.appendChild(g);h.appendChild(e);h.appendChild(k);d.appendChild(h)}};Solo.Dbfilters.loadTab=function(a){a={action:JSON.stringify({verb:"tab",root:a})};Solo.System.doAjax(a,function(a){Solo.Dbfilters.renderTab(a)},null,!1,15E3)};
Solo.Dbfilters.addRow=function(a,d){var c=Solo.Dbfilters.translations["COM_AKEEBA_DBFILTER_TYPE_"+a.type.toUpperCase()];null==c&&(c=a.type);var h=document.createElement("tr"),k=document.createElement("td"),e=document.createElement("td");h.className="ak_filter_row";k.className="ak_filter_type";k.textContent=c;e.className="ak_filter_item";var c=document.createElement("span"),g=document.createElement("span"),b=document.createElement("span");c.className="ak_filter_tab_icon_container btn btn-xs btn-default";
Solo.System.addEventListener(c,"click",function(){if(""==a.node){var b=this.parentNode.parentNode;b.parentNode.removeChild(b)}else b=document.getElementById("active_root"),Solo.Dbfilters.toggle({root:b.options[b.selectedIndex].value,node:a.node,filter:a.type,verb:"remove"},this,function(a,b){if(a.success){var c=b.parentNode.parentNode;c.parentNode.removeChild(c)}})});var f=document.createElement("span");f.className="ak-toggle-button fa fa-trash-o deletebutton";c.appendChild(f);g.className="ak_filter_tab_icon_container btn btn-xs btn-default";
Solo.System.addEventListener(g,"click",function(){if(null==this.parentNode.querySelector("input")){this.parentNode.querySelector("span.ak_filter_name").style.display="none";var b=document.createElement("input");b.setAttribute("type","text");b.setAttribute("size",60);b.value=this.parentNode.querySelector("span.ak_filter_name").textContent;this.parentNode.appendChild(b);Solo.System.addEventListener(b,"blur",function(){var b=this.value,c=this;if(""==b)Solo.System.triggerEvent(c.parentNode.querySelector("span.deletebutton"),
"click");else{var d=document.getElementById("active_root"),d={root:d.options[d.selectedIndex].value,old_node:a.node,new_node:b,filter:a.type,verb:"swap"},e=c.parentNode.querySelector("span.editcontainer");Solo.Dbfilters.toggle(d,e,function(d,g){Solo.System.removeClass(e,"btn-warning");Solo.System.addClass(e,"btn-default");var f=c.parentNode.querySelector("span.ak_filter_name");f.style.display="inline-block";f.textContent=b;c.parentNode.removeChild(c);a.node=b})}});b.focus()}});elEditIcon=document.createElement("span");
elEditIcon.className="ak-toggle-button fa fa-pencil-square editbutton";g.appendChild(elEditIcon);b.className="ak_filter_name";b.textContent=a.node;e.appendChild(c);e.appendChild(g);e.appendChild(b);h.appendChild(k);h.appendChild(e);d.appendChild(h)};
Solo.Dbfilters.addNew=function(a){Solo.Dbfilters.addRow({type:a,node:""},document.getElementById("ak_list_table").children[1]);a=document.getElementById("ak_list_table").children[1].children;Solo.System.triggerEvent(a[a.length-1].querySelector("span.editbutton"),"click")};Solo.Dbfilters.renderTab=function(a){var d=document.getElementById("ak_list_contents");d.innerHTML="";for(var c=0;c<a.length;c++)Solo.Dbfilters.addRow(a[c],d)};
Solo.Dbfilters.excludeNonCMS=function(){var a=document.getElementById("tables").children;for(counter=0;counter<a.length;counter++){var d=a[counter];if("#__"!=d.querySelector("span.table-name").textContent.substr(0,3)){var d=d.querySelector("span.table-icon-container"),c=d.querySelector("span.fa");-1==d.className.indexOf("btn-warning")&&Solo.System.triggerEvent(c,"click")}}};
Solo.Dbfilters.nuke=function(){var a={action:JSON.stringify({root:Solo.Dbfilters.currentRoot,verb:"reset"})};Solo.System.doAjax(a,function(a){Solo.Dbfilters.render(a)},null,!1,15E3)}; //# sourceMappingURL=dbfilters.min.map
