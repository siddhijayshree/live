/*
   2014-2017 Nicholas K. Dionysopoulos / Akeeba Ltd
 @license     GNU GPL version 3 or later
*/
if("undefined"==typeof Solo)var Solo={};"undefined"==typeof Solo.Update&&(Solo.Update={errorCallback:null,statistics:{inbytes:0,outbytes:0,files:0},factory:null,password:null,ajaxURL:null,mainURL:null,translations:{},nextStepUrl:"",finaliseUrl:""});
Solo.Update.downloadErrorCallback=function(a){document.getElementById("downloadProgressInfo").style.display="none";var b=document.getElementById("downloadProgressBarContainer");Solo.System.addClass(b,"progress-danger");Solo.System.removeClass(b,["active","progress-striped"]);document.getElementById("downloadErrorText").innerHTML=a;document.getElementById("downloadError").style.display="block"};
Solo.Update.extractErrorCallback=function(a){document.getElementById("extractProgressInfo").style.display="none";var b=document.getElementById("extractProgressBarContainer");Solo.System.addClass(b,"progress-danger");Solo.System.removeClass(b,["active","progress-striped"]);document.getElementById("extractErrorText").innerHTML=a;document.getElementById("extractError").style.display="block"};Solo.Update.nextStep=function(){window.location=Solo.Update.nextStepUrl};Solo.Update.onGenericError=function(a){alert(a)};
Solo.Update.setProgressBar=function(a,b){void 0==b&&(b="downloadProgressBar");var c;c=1>=a?100*a:a;0>c&&(c=0);100<c&&(c=100);var d=document.getElementById(b+"Container");100>c?(Solo.System.addClass(d,["active","progress-striped"]),Solo.System.removeClass(d,["progress-danger","progress-success"])):(Solo.System.removeClass(d,["active","progress-striped","progress-danger"]),Solo.System.addClass(d,"progress-success"));document.getElementById(b).style.width=c+"%";document.getElementById(b+"Info").innerText=
c+"%";Piecon.setProgress(c)};Solo.Update.humanFileSize=function(a,b){var c=b?1E3:1024;if(a<c)return a+" B";var d=b?"kB MB GB TB PB EB ZB YB".split(" "):"KiB MiB GiB TiB PiB EiB ZiB YiB".split(" "),e=-1;do a/=c,++e;while(a>=c);return a.toFixed(1)+" "+d[e]};
Solo.Update.startDownload=function(){Solo.Update.setProgressBar(0,"downloadProgressBar");Piecon.setOptions({color:"#333333",background:"#e0e0e0",shadow:"#000000",fallback:"force"});document.getElementById("downloadProgressBarText").innerHTML="";var a={task:"downloader",json:JSON.stringify({frag:-1,totalSize:-1})};Solo.System.doAjax(a,function(a){Solo.Update.stepDownload(a)},null,!1)};
Solo.Update.stepDownload=function(a){if(a.status){var b=0,c=0,d=0,e=-1;void 0!=a.totalSize&&(b=a.totalSize);void 0!=a.doneSize&&(c=a.doneSize);void 0!=a.percent&&(d=a.percent);void 0!=a.frag&&(e=a.frag);Solo.Update.setProgressBar(d,"downloadProgressBar");document.getElementById("downloadProgressBarText").innerText=d.toFixed(1)+"%";post={task:"downloader",json:JSON.stringify({frag:e,totalSize:b,doneSize:c})};if(100>d)Solo.System.doAjax(post,function(a){Solo.Update.stepDownload(a)},null,!1);else{Solo.Update.setProgressBar(100,
"downloadProgressBar");try{Piecon.reset()}catch(f){}Solo.Update.nextStep()}}else 300<=a.errorCode&&500>a.errorCode?Solo.Update.downloadErrorCallback(Solo.Update.translations.ERR_INVALIDDOWNLOADID):Solo.Update.downloadErrorCallback(a.error)};
Solo.Update.pingExtract=function(){Solo.Update.statistics.files=0;Solo.Update.statistics.inbytes=0;Solo.Update.statistics.outbytes=0;Solo.System.doEncryptedAjax({task:"ping"},function(a){Solo.Update.startExtract(a)},function(a){document.getElementById("extractProgress").style.display="none";document.getElementById("extractPingError").style.display="block"})};
Solo.Update.startExtract=function(){Solo.Update.statistics.files=0;Solo.Update.statistics.inbytes=0;Solo.Update.statistics.outbytes=0;Solo.System.doEncryptedAjax({task:"startRestore"},function(a){Solo.Update.stepExtract(a)})};
Solo.Update.stepExtract=function(a){if(0==a.status)Solo.System.errorCallback(a.message);else{if(void 0!=a.totalsize){if(is_array(a.filelist))for(var b=Solo.Update.statistics.totalSize=0;b<a.filelist.length;b++)Solo.Update.statistics.totalSize+=a.filelist[b][1];Solo.Update.statistics.files=0;Solo.Update.statistics.inbytes=0;Solo.Update.statistics.outbytes=0}Solo.Update.statistics.files+=a.files;Solo.Update.statistics.inbytes+=a.bytesIn;Solo.Update.statistics.outbytes+=a.bytesOut;b=0;0<Solo.Update.statistics.totalSize&&
(b=100*Solo.Update.statistics.inbytes/Solo.Update.statistics.totalSize,0>b?b=0:100<b&&(b=100));a.done&&(b=100);Solo.Update.setProgressBar(b,"extractProgressBar");document.getElementById("extractProgressBarTextPercent").innerText=b.toFixed(1);document.getElementById("extractProgressBarTextIn").innerText=Solo.Update.humanFileSize(Solo.Update.statistics.inbytes,0)+" / "+Solo.Update.humanFileSize(Solo.Update.statistics.totalSize,0);document.getElementById("extractProgressBarTextOut").innerText=Solo.Update.humanFileSize(Solo.Update.outbytes,
0);document.getElementById("extractProgressBarTextFile").innerText=a.lastfile;empty(a.factory)||(Solo.Update.factory=a.factory);a.done?Solo.Update.finalizeUpdate():(post={task:"stepRestore",factory:a.factory},Solo.System.doEncryptedAjax(post,function(a){Solo.Update.stepExtract(a)}))}};Solo.Update.finalizeUpdate=function(){Solo.System.doEncryptedAjax({task:"finalizeRestore",factory:Solo.Update.factory},function(a){window.location=Solo.Update.finaliseUrl})}; //# sourceMappingURL=update.min.map
