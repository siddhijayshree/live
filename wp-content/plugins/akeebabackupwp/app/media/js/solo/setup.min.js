/*
   2014-2017 Nicholas K. Dionysopoulos / Akeeba Ltd
 @license     GNU GPL version 3 or later
*/
if("undefined"==typeof Solo)var Solo={};"undefined"==typeof Solo.Setup&&(Solo.Setup={},Solo.Setup.translations={},Solo.Setup.URLs={},Solo.Setup.FtpBrowser={params:{}},Solo.Setup.SftpBrowser={params:{}},Solo.Setup.FtpTest={},Solo.Setup.SftpTest={});Solo.Setup.onFsDriverClick=function(a){a=document.getElementById("fs_driver").value;document.getElementById("ftp_options").style.display="ftp"==a||"sftp"==a?"block":"none"};
Solo.Setup.init=function(){Solo.System.addEventListener(document.getElementById("fs_driver"),"change",Solo.Setup.onFsDriverClick);this.onFsDriverClick()};Solo.Setup.FtpBrowser.callback=function(a){var b="/".replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1");a="/"+(a+"").replace(new RegExp("^["+b+"]+","g"),"");document.getElementById(Solo.Setup.FtpBrowser.params.key).value=a};
Solo.Setup.FtpBrowser.initialise=function(a,b){Solo.Setup.FtpBrowser.params.host=document.getElementById(b+"_host").value;Solo.Setup.FtpBrowser.params.port=document.getElementById(b+"_port").value;Solo.Setup.FtpBrowser.params.username=document.getElementById(b+"_username").value;Solo.Setup.FtpBrowser.params.password=document.getElementById(b+"_password").value;Solo.Setup.FtpBrowser.params.passive=!0;Solo.Setup.FtpBrowser.params.ssl=!1;Solo.Setup.FtpBrowser.params.directory=document.getElementById(b+
"_directory").value;Solo.Setup.FtpBrowser.params.key=a;Solo.Setup.FtpBrowser.open()};
Solo.Setup.FtpBrowser.open=function(){var a=document.getElementById("ftpdialog");a.style.display="block";Solo.System.addEventListener("ftpdialogOkButton","click",function(b){Solo.Setup.FtpBrowser.callback(Solo.Setup.FtpBrowser.params.directory);Solo.Setup.FtpBrowser.Modal.close()});Solo.Setup.FtpBrowser.Modal=Solo.Modal.open({inherit:a,width:"450",height:"280"});a.modal("show");document.getElementById("ftpBrowserErrorContainer").style.display="none";document.getElementById("ftpBrowserFolderList").innerHTML=
"";document.getElementById("ftpBrowserCrumbs").innerHTML="";Solo.System.params.AjaxURL=Solo.Setup.URLs.ftpBrowser;empty(Solo.Setup.FtpBrowser.params.directory)&&(Solo.Setup.FtpBrowser.params.directory="");Solo.System.doAjax({host:Solo.Setup.FtpBrowser.params.host,port:Solo.Setup.FtpBrowser.params.port,username:Solo.Setup.FtpBrowser.params.username,password:Solo.Setup.FtpBrowser.params.password,passive:Solo.Setup.FtpBrowser.params.passive?1:0,ssl:Solo.Setup.FtpBrowser.params.ssl?1:0,directory:Solo.Setup.FtpBrowser.params.directory},
function(b){if(0!=b.error)document.getElementById("ftpBrowserError").innerHTML=b.error,document.getElementById("ftpBrowserErrorContainer").style.display="block",document.getElementById("ftpBrowserFolderList").style.display="none",document.getElementById("ak_crumbs").style.display="none";else{document.getElementById("ftpBrowserErrorContainer").style.display="none";if(empty(b.breadcrumbs))document.getElementById("ftpBrowserCrumbs").style.display="none";else{var a=document.getElementById("ak_crumbs");
a.style.display="block";a.innerHTML="";var c="/";Solo.Setup.FtpBrowser.addCrumb(Solo.Setup.translations["UI-ROOT"],"/",a);for(var e=0;e<b.breadcrumbs.length;e++){var f=b.breadcrumbs[e],c=c+("/"+f);Solo.Setup.FtpBrowser.addCrumb(f,c,a)}}if(empty(b.list))document.getElementById("ftpBrowserFolderList").style.display="none";else for(document.getElementById("ftpBrowserFolderList").style.display="block",a=0;a<b.list.length;a++)c=b.list[a],Solo.Setup.FtpBrowser.createLink(Solo.Setup.FtpBrowser.params.directory+
"/"+c,c,document.getElementById("ftpBrowserFolderList"))}},function(b){document.getElementById("ftpBrowserError").innerHTML=b;document.getElementById("ftpBrowserErrorContainer").style.display="block";document.getElementById("ftpBrowserFolderList").style.display="none";document.getElementById("ftpBrowserCrumbs").style.display="none"},!1)};
Solo.Setup.FtpBrowser.createLink=function(a,b,d,c){"undefined"==typeof c&&(c=Solo.Setup.FtpBrowser);var e=document.createElement("tr"),f=document.createElement("td");e.appendChild(f);var g=document.createElement("a");g.innerText=b;Solo.System.addEventListener(g,"click",function(b){c.params.directory=a;c.open()});f.appendChild(g);d.appendChild(e)};
Solo.Setup.FtpBrowser.addCrumb=function(a,b,d,c){"undefined"==typeof c&&(c=Solo.Setup.FtpBrowser);var e=document.createElement("li"),f=document.createElement("a");f.innerHTML=a;Solo.System.addEventListener(f,"click",function(a){c.params.directory=b;c.open();a.preventDefault()});e.appendChild(f);d.appendChild(e)};
Solo.Setup.SftpBrowser.initialise=function(a,b){Solo.Setup.SftpBrowser.params.host=document.getElementById(b+"_host").value;Solo.Setup.SftpBrowser.params.port=document.getElementById(b+"_port").value;Solo.Setup.SftpBrowser.params.username=document.getElementById(b+"_username").value;Solo.Setup.SftpBrowser.params.password=document.getElementById(b+"_password").value;Solo.Setup.SftpBrowser.params.directory=document.getElementById(b+"_directory").value;Solo.Setup.SftpBrowser.params.privKey="";Solo.Setup.SftpBrowser.params.pubKey=
"";Solo.Setup.FtpBrowser.params.key=a;Solo.Setup.SftpBrowser.open()};
Solo.Setup.SftpBrowser.open=function(){var a=document.getElementById("sftpdialog");a.style.display="block";Solo.System.addEventListener(document.getElementById("sftpdialogOkButton"),"click",function(b){Solo.Setup.FtpBrowser.callback(Solo.Setup.SftpBrowser.params.directory);Solo.Setup.SftpBrowser.Modal.close()});Solo.Setup.SftpBrowser.Modal=Solo.Modal.open({inherit:a,width:"450",height:"280"});document.getElementById("sftpBrowserErrorContainer").style.display="none";document.getElementById("sftpBrowserFolderList").innerHTML=
"";document.getElementById("sftpBrowserCrumbs").innerHTML="";Solo.System.params.AjaxURL=Solo.Setup.URLs.sftpBrowser;empty(Solo.Setup.SftpBrowser.params.directory)&&(Solo.Setup.SftpBrowser.params.directory="");Solo.System.doAjax({host:Solo.Setup.SftpBrowser.params.host,port:Solo.Setup.SftpBrowser.params.port,username:Solo.Setup.SftpBrowser.params.username,password:Solo.Setup.SftpBrowser.params.password,directory:Solo.Setup.SftpBrowser.params.directory,privkey:Solo.Setup.SftpBrowser.params.privKey,
pubkey:Solo.Setup.SftpBrowser.params.pubKey},function(b){if(0!=b.error)document.getElementById("sftpBrowserError").innerHTML=b.error,document.getElementById("sftpBrowserErrorContainer").style.display="block",document.getElementById("sftpBrowserFolderList").style.display="none",document.getElementById("ak_scrumbs").style.display="none";else{document.getElementById("ftpBrowserErrorContainer").style.display="none";if(empty(b.breadcrumbs))document.getElementById("sftpBrowserCrumbs").style.display="none";
else{var a=document.getElementById("ak_scrumbs");a.style.display="block";a.innerHTML="";var c="/";Solo.Setup.FtpBrowser.addCrumb(Solo.Setup.translations["UI-ROOT"],"/",a,Solo.Setup.SftpBrowser);for(var e=0;e<b.breadcrumbs.length;e++){var f=b.breadcrumbs[e],c=c+("/"+f);Solo.Setup.FtpBrowser.addCrumb(f,c,a,Solo.Setup.SftpBrowser)}}if(empty(b.list))document.getElementById("sftpBrowserFolderList").style.display="none";else for(document.getElementById("sftpBrowserFolderList").style.display="block",a=0;a<
b.list.length;a++)c=b.list[a],Solo.Setup.FtpBrowser.createLink(Solo.Setup.SftpBrowser.params.directory+"/"+c,c,document.getElementsByClassName("sftpBrowserFolderList"),Solo.Setup.SftpBrowser)}},function(a){document.getElementById("sftpBrowserError").innerHTML=a;document.getElementById("sftpBrowserErrorContainer").style.display="block";document.getElementById("sftpBrowserFolderList").style.display="none";document.getElementById("sftpBrowserCrumbs").style.display="none"},!1)};
Solo.Setup.FtpTest.testConnection=function(a,b){var d=document.getElementById(a);Solo.Setup.FtpTest.buttonKey=a;d.setAttribute("disabled","disabled");d={host:document.getElementById(b+"_host").value,port:document.getElementById(b+"_port").value,user:document.getElementById(b+"_username").value,pass:document.getElementById(b+"_password").value,initdir:document.getElementById(b+"_directory").value,usessl:!1,passive:!0};Solo.System.params.AjaxURL=Solo.Setup.URLs.testFtp;Solo.System.doAjax(d,function(a){document.getElementById(Solo.Setup.FtpTest.buttonKey).removeAttribute("disabled");
var b=document.getElementById("testFtpDialogBodyOk"),c=document.getElementById("testFtpDialogBodyFail"),d=document.getElementById("testFtpDialogLabel");b.style.display="none";c.style.display="none";!0===a?(d.innerHTML=Solo.Setup.translations["UI-TESTFTP-OK"],b.innerHTML=Solo.Setup.translations["UI-TESTFTP-OK"],b.style.display="block",c.style.display="none"):(d.innerHTML=Solo.Setup.translations["UI-TESTFTP-FAIL"],c.html(a),b.style.display="none",c.style.display="block");Solo.Setup.FtpTest.Modal=Solo.Modal.open({inherit:document.getElementById("testFtpDialog"),
width:"450",height:"280"})},null,!1,15E3)};
Solo.Setup.SftpTest.testConnection=function(a,b){var d=document.getElementById(a);Solo.Setup.SftpTest.buttonKey=a;d.setAttribute("disabled","disabled");d={host:document.getElementById(b+"_host").value,port:document.getElementById(b+"_port").value,user:document.getElementById(b+"_username").value,pass:document.getElementById(b+"_password").value,initdir:document.getElementById(b+"_directory").value,privkey:"",pubkey:""};Solo.System.params.AjaxURL=Solo.Setup.URLs.testSftp;Solo.System.doAjax(d,function(a){document.getElementById(Solo.Setup.SftpTest.buttonKey).removeAttr("disabled");
var b=document.getElementById("testFtpDialogBodyOk"),c=document.getElementById("testFtpDialogBodyFail"),d=document.getElementById("testFtpDialogLabel");b.style.display="none";c.style.display="none";!0===a?(d.innerHTML=Solo.Setup.translations["UI-TESTSFTP-OK"],b.innerHTML=Solo.Setup.translations["UI-TESTSFTP-OK"],b.style.display="block",c.style.display="none"):(d.innerHTML=Solo.Setup.translations["UI-TESTSFTP-FAIL"],c.innerHTML=a,b.style.display="none",c.style.display="block");Solo.Setup.FtpTest.Modal=
Solo.Modal.open({inherit:document.getElementById("testFtpDialog"),width:"450",height:"280"})},null,!1,15E3)};Solo.Setup.initFtpSftpBrowser=function(){var a=document.getElementById("fs_driver").value;"ftp"==a?Solo.Setup.FtpBrowser.initialise("fs_directory","fs"):"sftp"==a&&Solo.Setup.SftpBrowser.initialise("fs_directory","fs");return!1};
Solo.Setup.testFtpSftpConnection=function(){var a=document.getElementById("fs_driver").value;"ftp"==a?Solo.Setup.FtpTest.testConnection("btnFtpTest","fs"):"sftp"==a&&Solo.Setup.SftpTest.testConnection("btnFtpTest","fs");return!1}; //# sourceMappingURL=setup.min.map
